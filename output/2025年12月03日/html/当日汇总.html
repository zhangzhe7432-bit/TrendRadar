
    <!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>热点新闻分析</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" integrity="sha512-BNaRQnYJYiPSqHHDb58B0yaPfCu+Wgds8Gp/gU33kqBtgNS4tSPHuGibyoeqMV/TJlSKda6FXzoEyYGjTe+vXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <style>
            * { box-sizing: border-box; }
            body { 
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
                margin: 0; 
                padding: 16px; 
                background: #fafafa;
                color: #333;
                line-height: 1.5;
            }
            
            .container {
                max-width: 600px;
                margin: 0 auto;
                background: white;
                border-radius: 12px;
                overflow: hidden;
                box-shadow: 0 2px 16px rgba(0,0,0,0.06);
            }
            
            .header {
                background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
                color: white;
                padding: 32px 24px;
                text-align: center;
                position: relative;
            }
            
            .save-buttons {
                position: absolute;
                top: 16px;
                right: 16px;
                display: flex;
                gap: 8px;
            }
            
            .save-btn {
                background: rgba(255, 255, 255, 0.2);
                border: 1px solid rgba(255, 255, 255, 0.3);
                color: white;
                padding: 8px 16px;
                border-radius: 6px;
                cursor: pointer;
                font-size: 13px;
                font-weight: 500;
                transition: all 0.2s ease;
                backdrop-filter: blur(10px);
                white-space: nowrap;
            }
            
            .save-btn:hover {
                background: rgba(255, 255, 255, 0.3);
                border-color: rgba(255, 255, 255, 0.5);
                transform: translateY(-1px);
            }
            
            .save-btn:active {
                transform: translateY(0);
            }
            
            .save-btn:disabled {
                opacity: 0.6;
                cursor: not-allowed;
            }
            
            .header-title {
                font-size: 22px;
                font-weight: 700;
                margin: 0 0 20px 0;
            }
            
            .header-info {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 16px;
                font-size: 14px;
                opacity: 0.95;
            }
            
            .info-item {
                text-align: center;
            }
            
            .info-label {
                display: block;
                font-size: 12px;
                opacity: 0.8;
                margin-bottom: 4px;
            }
            
            .info-value {
                font-weight: 600;
                font-size: 16px;
            }
            
            .content {
                padding: 24px;
            }
            
            .word-group {
                margin-bottom: 40px;
            }
            
            .word-group:first-child {
                margin-top: 0;
            }
            
            .word-header {
                display: flex;
                align-items: center;
                justify-content: space-between;
                margin-bottom: 20px;
                padding-bottom: 8px;
                border-bottom: 1px solid #f0f0f0;
            }
            
            .word-info {
                display: flex;
                align-items: center;
                gap: 12px;
            }
            
            .word-name {
                font-size: 17px;
                font-weight: 600;
                color: #1a1a1a;
            }
            
            .word-count {
                color: #666;
                font-size: 13px;
                font-weight: 500;
            }
            
            .word-count.hot { color: #dc2626; font-weight: 600; }
            .word-count.warm { color: #ea580c; font-weight: 600; }
            
            .word-index {
                color: #999;
                font-size: 12px;
            }
            
            .news-item {
                margin-bottom: 20px;
                padding: 16px 0;
                border-bottom: 1px solid #f5f5f5;
                position: relative;
                display: flex;
                gap: 12px;
                align-items: center;
            }
            
            .news-item:last-child {
                border-bottom: none;
            }
            
            .news-item.new::after {
                content: "NEW";
                position: absolute;
                top: 12px;
                right: 0;
                background: #fbbf24;
                color: #92400e;
                font-size: 9px;
                font-weight: 700;
                padding: 3px 6px;
                border-radius: 4px;
                letter-spacing: 0.5px;
            }
            
            .news-number {
                color: #999;
                font-size: 13px;
                font-weight: 600;
                min-width: 20px;
                text-align: center;
                flex-shrink: 0;
                background: #f8f9fa;
                border-radius: 50%;
                width: 24px;
                height: 24px;
                display: flex;
                align-items: center;
                justify-content: center;
                align-self: flex-start;
                margin-top: 8px;
            }
            
            .news-content {
                flex: 1;
                min-width: 0;
                padding-right: 40px;
            }
            
            .news-item.new .news-content {
                padding-right: 50px;
            }
            
            .news-header {
                display: flex;
                align-items: center;
                gap: 8px;
                margin-bottom: 8px;
                flex-wrap: wrap;
            }
            
            .source-name {
                color: #666;
                font-size: 12px;
                font-weight: 500;
            }
            
            .rank-num {
                color: #fff;
                background: #6b7280;
                font-size: 10px;
                font-weight: 700;
                padding: 2px 6px;
                border-radius: 10px;
                min-width: 18px;
                text-align: center;
            }
            
            .rank-num.top { background: #dc2626; }
            .rank-num.high { background: #ea580c; }
            
            .time-info {
                color: #999;
                font-size: 11px;
            }
            
            .count-info {
                color: #059669;
                font-size: 11px;
                font-weight: 500;
            }
            
            .news-title {
                font-size: 15px;
                line-height: 1.4;
                color: #1a1a1a;
                margin: 0;
            }
            
            .news-link {
                color: #2563eb;
                text-decoration: none;
            }
            
            .news-link:hover {
                text-decoration: underline;
            }
            
            .news-link:visited {
                color: #7c3aed;
            }
            
            .new-section {
                margin-top: 40px;
                padding-top: 24px;
                border-top: 2px solid #f0f0f0;
            }
            
            .new-section-title {
                color: #1a1a1a;
                font-size: 16px;
                font-weight: 600;
                margin: 0 0 20px 0;
            }
            
            .new-source-group {
                margin-bottom: 24px;
            }
            
            .new-source-title {
                color: #666;
                font-size: 13px;
                font-weight: 500;
                margin: 0 0 12px 0;
                padding-bottom: 6px;
                border-bottom: 1px solid #f5f5f5;
            }
            
            .new-item {
                display: flex;
                align-items: center;
                gap: 12px;
                padding: 8px 0;
                border-bottom: 1px solid #f9f9f9;
            }
            
            .new-item:last-child {
                border-bottom: none;
            }
            
            .new-item-number {
                color: #999;
                font-size: 12px;
                font-weight: 600;
                min-width: 18px;
                text-align: center;
                flex-shrink: 0;
                background: #f8f9fa;
                border-radius: 50%;
                width: 20px;
                height: 20px;
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            .new-item-rank {
                color: #fff;
                background: #6b7280;
                font-size: 10px;
                font-weight: 700;
                padding: 3px 6px;
                border-radius: 8px;
                min-width: 20px;
                text-align: center;
                flex-shrink: 0;
            }
            
            .new-item-rank.top { background: #dc2626; }
            .new-item-rank.high { background: #ea580c; }
            
            .new-item-content {
                flex: 1;
                min-width: 0;
            }
            
            .new-item-title {
                font-size: 14px;
                line-height: 1.4;
                color: #1a1a1a;
                margin: 0;
            }
            
            .error-section {
                background: #fef2f2;
                border: 1px solid #fecaca;
                border-radius: 8px;
                padding: 16px;
                margin-bottom: 24px;
            }
            
            .error-title {
                color: #dc2626;
                font-size: 14px;
                font-weight: 600;
                margin: 0 0 8px 0;
            }
            
            .error-list {
                list-style: none;
                padding: 0;
                margin: 0;
            }
            
            .error-item {
                color: #991b1b;
                font-size: 13px;
                padding: 2px 0;
                font-family: 'SF Mono', Consolas, monospace;
            }
            
            .footer {
                margin-top: 32px;
                padding: 20px 24px;
                background: #f8f9fa;
                border-top: 1px solid #e5e7eb;
                text-align: center;
            }
            
            .footer-content {
                font-size: 13px;
                color: #6b7280;
                line-height: 1.6;
            }
            
            .footer-link {
                color: #4f46e5;
                text-decoration: none;
                font-weight: 500;
                transition: color 0.2s ease;
            }
            
            .footer-link:hover {
                color: #7c3aed;
                text-decoration: underline;
            }
            
            .project-name {
                font-weight: 600;
                color: #374151;
            }
            
            @media (max-width: 480px) {
                body { padding: 12px; }
                .header { padding: 24px 20px; }
                .content { padding: 20px; }
                .footer { padding: 16px 20px; }
                .header-info { grid-template-columns: 1fr; gap: 12px; }
                .news-header { gap: 6px; }
                .news-content { padding-right: 45px; }
                .news-item { gap: 8px; }
                .new-item { gap: 8px; }
                .news-number { width: 20px; height: 20px; font-size: 12px; }
                .save-buttons {
                    position: static;
                    margin-bottom: 16px;
                    display: flex;
                    gap: 8px;
                    justify-content: center;
                    flex-direction: column;
                    width: 100%;
                }
                .save-btn {
                    width: 100%;
                }
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="header">
                <div class="save-buttons">
                    <button class="save-btn" onclick="saveAsImage()">保存为图片</button>
                    <button class="save-btn" onclick="saveAsMultipleImages()">分段保存</button>
                </div>
                <div class="header-title">热点新闻分析</div>
                <div class="header-info">
                    <div class="info-item">
                        <span class="info-label">报告类型</span>
                        <span class="info-value">当日汇总</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">新闻总数</span>
                        <span class="info-value">603 条</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">热点新闻</span>
                        <span class="info-value">29 条</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">生成时间</span>
                        <span class="info-value">12-03 23:51</span>
                    </div>
                </div>
            </div>
            
            <div class="content">
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name">打架 斗殴 群殴 冲突 纠纷 争吵 推搡 打人 殴打 暴力行为 持刀 持械 伤人 砍人 砍伤 袭击 攻击 报复 追打 街头冲突 夜间冲突 暴力画面 暴力事件 强行拉扯 骚扰 性骚扰 尾随 跟踪 偷窥 偷拍 针孔摄像头 偷窥设备 偷拍设备 偷拍画面 偷看 更衣偷拍 偷拍卫生间 猥亵 猥亵行为 骚扰女性 醉酒闹事 酒后闹事 酒后失控 喝醉打人 店铺冲突 店员被打 顾客闹事 服务纠纷升级 堂食冲突 路边冲突 街边殴打 陌生人冲突 邻里纠纷升级 家庭暴力 家暴现场 父母打孩子 监护不当 虐待行为 虐待儿童 老人被打 推打老人 虐待老人 公共场所冲突 地铁冲突 公交冲突 车厢冲突 高铁冲突 闯入 强闯 恶意破坏 砸店 砸车 店铺被砸 车子被砸 恶意泼水 泼油 恐吓 威胁 威胁行为 口角升级 情绪失控 情绪爆发 互骂 群体冲突 围殴 打架 斗殴 群殴 冲突 矛盾激化 纠纷 争执 争吵 口角 推搡 拉扯 撕扯 对骂 骂战 互殴 冲上去打 动手打人 报复性殴打 报复性冲突 突然发火 撕逼 起冲突 吵得很凶 闹矛盾 动粗 闹事 滋事 寻衅滋事 闹得不可开交 爆发冲突 争论升级 吵到失控 吵到报警 吵红了脸 拉架 劝架失败 争吵不断 邻里冲突 邻里纠纷 家庭纠纷 夫妻吵架 情侣吵架 婆媳矛盾 父子冲突 家庭争执 家庭不和 家庭暴躁 家庭关系破裂 激烈争吵 矛盾升级 打到外面 砸东西 扔东西 桌椅被掀 摔东西 怒气冲天 火气大 忍不了了 被激怒 冲突视频 打人视频 发生冲突 现场冲突 冲突全过程 冲突曝光 严重冲突 激烈冲突 打红了眼 打得很狠 冲突报警 报警处理 情绪失控 气得发抖 吵得难听 对骂升级 互相推搡 互殴现场 街头冲突 店内冲突 小区冲突 工地冲突 学校冲突 校园冲突 学生冲突 同学打架 孩子打架 家长冲突 老师家长冲突 校园纠纷 教育纠纷 培训机构冲突 门店冲突 商家与顾客冲突 顾客与员工冲突 餐厅冲突 饭店冲突 酒店冲突 宾馆冲突 超市冲突 商场冲突 停车场冲突 路边冲突 街头骚动 公共场所争执 公交冲突 地铁冲突 服务站冲突 医院冲突 急诊冲突 医患冲突 患者家属冲突 看病吵架 排队冲突 排队插队冲突 插队被打 插队引发冲突 排队引纠纷 婚礼冲突 宴席冲突 酒后冲突 醉酒打架 喝醉闹事 醉酒殴打 酒后发疯 醉酒挑衅 酒后找茬 酒后不理智 喝多了打架 醉酒冲突升级 夜店冲突 KTV冲突 聚会冲突 饭局冲突 麻将馆冲突 棋牌室冲突 棋牌馆争吵 赌博引冲突 欠钱引冲突 借钱不还吵架 金钱纠纷 还钱纠纷 合同纠纷 租房纠纷 租客与房东冲突 搬家纠纷 水电费纠纷 费用纠纷 退款纠纷 消费纠纷 投诉纠纷 售后纠纷 拖欠工资纠纷 工人讨薪冲突 工资不发闹事 维权冲突 讨说法冲突 群体争执 群体冲突 多人冲突 现场混乱 人群围观冲突 围观群众激动 激化矛盾 矛盾爆发 失控场面 场面混乱 打得激烈 打到受伤 冲突导致受伤 被打骨折 头破血流 脸被抓伤 身体受伤 打到流血 打到晕倒 打到送医 冲突严重后果 冲突背后原因 冲突失控现场 冲突无人制止 冲突升级画面 暴力行为 暴力倾向 暴力冲突 暴力事件 暴力场面 暴力打人 暴力骂人 恶意攻击 恶意挑衅 挑衅行为 挑事行为 找茬 堵门 堵住不让走 拦住对方 威胁恐吓 恐吓吓唬 言语攻击 言语羞辱 侮辱性语言 羞辱行为 故意激怒 故意对骂 故意挑衅 忍无可忍 气到爆 情绪对抗 情绪冲突 冲突吵得很大 吵得整个楼道都听见 互不退让 双方僵持 僵持不下 僵持十几分钟 僵持很久 僵局 吵到凌晨 吵醒邻居 吵得全楼都听到 扰民冲突 深夜吵架 夜间争执 夜间大声吵闹 声音很大 喊叫声 哭喊声 尖叫声 哭闹声 激动大喊 激动吼叫 吵得心烦 因小事争吵 琐事引冲突 误会引争执 冲突不断 频繁冲突 小区居民吵架 小区群体纠纷 小区业主冲突 业主吵架 业主投诉引冲突 物业与业主冲突 物业矛盾激化 车位冲突 停车冲突 停车位纠纷 占车位吵架 乱停引冲突 撞车引冲突 追尾引冲突 事故冲突 交通事故争执 事故后冲突升级 司机争吵 司机互骂 乘客与司机冲突 公交上吵架 出租车冲突 网约车冲突 违反规定引争吵 排队抢座引冲突 公共资源争夺 广场冲突 体育馆冲突 健身房冲突 游泳馆冲突 景区冲突 旅游纠纷 旅客冲突 导游冲突 服务纠纷 旅游被坑引纠纷 拍照纠纷 拍摄冲突 偷拍引冲突 偷拍被抓冲突 偷拍引发争执 偷拍被围 偷拍被揪出 偷拍者被打 争抢资源 争抢座位 争抢玩具 孩子之间冲突 孩子推搡 家长介入冲突 学校门口冲突 幼儿园冲突 培训班纠纷 补课纠纷 老师家长争吵 老师与家长矛盾 学生家长闹事 学生打架 学生被欺负 校园欺凌 霸凌行为 霸凌曝光 校园暴力 学生矛盾激化 学生互殴 学生冲突视频 老师情绪冲突 老师动怒 老师发火 老师被怒怼 老师和家长吵起来 同事冲突 职场冲突 单位冲突 上下级冲突 办公地点纠纷 工作矛盾 工地工人冲突 工地纠纷升级 包工头冲突 工地打架 装修纠纷打架 装修队纠纷 装修工人与业主冲突 装修款纠纷 工程款纠纷 劳务纠纷 店铺冲突 餐饮冲突 顾客发火 顾客砸店 顾客怒骂 顾客推搡员工 员工被打 店员被骂 摔餐盘 砸柜台 服务态度引冲突 排队太久引冲突 等太久吵起来 退款吵架 退货吵架 售后吵架 纠纷升级报警 争执报警 报警处理纠纷 警察到场 警方介入 现场调解 矛盾调处失败 冲突再次发生 再次吵架 吵架反复发生 长期矛盾 积怨已久 长期冲突 互相看不顺眼 邻居长期吵架 家里长期争吵 车祸 事故 交通事故 重大事故 轻微事故 追尾 连环追尾 撞车 撞人 碾压 压人 压车 冲卡 闯红灯 逆行 占道 违停 乱停 堵路 堵车 路怒 飙车 炸街 危险驾驶 疲劳驾驶 斗气车 逼车 变道冲突 摩托乱窜 摩托飙车 电动车乱行 电动车闯红灯 骑手冲突 外卖撞人 货车事故 大货车冲撞 侧翻 翻车 失控 漂移 顶包 逃逸 肇事逃逸 事故现场 事故曝光 行车记录仪曝光 事故还原 着火 火灾 冒烟 起火 自燃 自燃车辆 电瓶车起火 燃气泄漏 煤气泄漏 液化气泄漏 爆燃 爆炸 闪爆 明火 着火点 火势大 浓烟 黑烟 刺鼻气味 疑似起火 消防通道堵塞 消防不达标 灭火器失效 消防隐患 逃生困难 火灾警报 烟雾弥漫 小区起火 工厂起火 仓库着火 厨房失火 电线短路引发火灾 诈骗 电信诈骗 网络诈骗 套路 坑骗 骗局 杀猪盘 裸聊诈骗 返利诈骗 刷单诈骗 兼职诈骗 虚假兼职 高薪骗局 缴费骗局 投资骗局 资金盘 假理财 假基金 假客服 冒充客服 冒充公检法 冒充熟人 冻结账户诈骗 假快递 假物流 骗运费 强制下载App 冒充房东 租房诈骗 订金诈骗 预付诈骗 假助学金 校园贷 套路贷 低息贷陷阱 网贷陷阱 信用卡诈骗 机票退票诈骗 酒店预订诈骗 游戏币骗局 账号买卖骗局 买号被骗 卖号被骗 交易被骗 社交软件诈骗 婚恋诈骗 照片骗人 虚假身份 医疗事故 误诊 漏诊 态度差 服务差 护士凶 护士态度差 医生不理 医生冷漠 乱收费 重复收费 过度治疗 检查太贵 不让看 推诿治疗 救护车收费贵 医院不作为 医疗纠纷 医闹 家属冲突 挂号困难 排队时间长 看病难 挂号难 挂不到号 号源被抢 黄牛倒号 排队太久 排队四小时 排队半天 排队看不到 等一天没看上 科室爆满 人太多 就医秩序混乱 急诊混乱 急诊拥堵 急诊人满 急诊堵塞 抢救室超负荷 抢救不及时 医生态度差 护士态度差 医生态度冷漠 服务冷漠 诊疗不规范 瞎检查 乱检查 乱开药 开贵药 天价药 天价治疗 贵得离谱 收费不透明 收费过高 乱收费 重复收费 检查太贵 检查不必要 误诊 漏诊 延误治疗 延误病情 不作为 推卸责任 踢皮球 护理不到位 不负责任态度 病人投诉 病人情绪激动 家属情绪崩溃 医患纠纷 医院纠纷 家属质疑 对医院不满 手术失败 手术事故 手术风险未告知 家属冲突 就医冲突 病房混乱 病房脏乱 病房管理混乱 病房卫生差 餐饮不卫生 医院饭菜难吃 医院收费争议 医保争议 费用不合理 交钱先治疗 治疗效果差 治疗无效果 治疗失败 治疗态度差 输液错误 用药错误 剂量错误 化验错误 数据错误 CT错误 报告错误 医生不看报告 医生敷衍了事 值班不在 无人值守 无人理 找不到医生 护士动作粗暴 护士态度恶劣 病情不重不管 病情重还拖 不重视病人 不耐烦脸色 病人受委屈 老人看病难 孩子看病难 儿童急诊难 孕妇看病难 妇产科混乱 新生儿纠纷 小诊所问题 黑诊所 假医生 资质不明诊所 违规行医 非法行医 非法美容 医美翻车 医美失败 整形失败 整形事故 整容事故 医美维权 玻尿酸失败 打针坏脸 面部变形 感染红肿 手术感染 术后并发症 诊所跑路 医美机构跑路 老师体罚 老师打骂 老师骂人 老师偏心 学生冲突 校园暴力 校园欺凌 学生受伤 学校不管 管理混乱 学校乱收费 补课费用高 强制补课 教育资源差 课堂冲突 宿舍管理差 学生走失 学校管理混乱 老师态度差 辅导不负责 教学混乱 课堂秩序差 欺凌事件 校园欺凌 校园暴力 学生被打 学生被欺负 霸凌曝光 老师发脾气 老师体罚 体罚学生 变相体罚 侮辱学生 情绪失控老师 老师骂学生 老师歧视学生 老师偏心 老师推诿 老师敷衍 教学质量差 教学不认真 作业太多 补课收费 强制补课 乱收费 家委会乱收费 班费争议 校服乱收费 伙食差 营养餐差 学校饭菜难吃 异物 学校吃出异物 饭菜不卫生 学校卫生差 宿舍混乱 宿舍安全隐患 校车安全 校车违规 校车超载 老师和家长吵架 家长维权 学校维权难 学生意外事故 学校管理不当 校园安全隐患 学生走失 校园门口混乱 迟到不让进争议 家长堵门 校门口冲突 学校投诉不断 物业差 物业态度差 不作为 乱收费 停车费贵 乱涨价 小区混乱 电动车乱停 消防不达标 监控坏 不修 外墙脱落 小区漏水 电梯关人 电梯故障 路灯不亮 无人管理 邻里矛盾 狗扰民 遛狗不拴绳 业主投诉无果 物业不作为 物业乱收费 物业态度差 物业管理差 物业服务差 物业不处理 物业不回应 物业不负责 物业推诿 物业敷衍 物业收费不合理 物业费太贵 停车费太贵 停车难 车位紧张 车位被占 停车被堵 堵门 乱停车 小区道路拥堵 小区黄牛 黄牛霸车位 小区治安差 小区偷东西 盗窃 小区有人打架 小区狗咬人 宠物扰民 遛狗不牵绳 流浪狗问题 小区垃圾多 小区卫生差 垃圾堆放 恶臭 小区环境脏乱 小区施工扰民 装修扰民 噪音扰民 深夜噪音 吵到邻居 小区漏水 小区停水 小区停电 停水不停通知 电梯坏 电梯故障 电梯维修慢 电梯困人 电梯掉层 电梯安全隐患 楼道堆放杂物 楼道堵塞 消防隐患 消防通道被堵 违建 违规搭建 乱搭乱建 占用公共区域 绿化被破坏 小区照明差 公共设施破损 泳池管理混乱 健身房问题 小区业主维权 业主冲突 业主骂物业 业主堵门 业主群吵架 业主大会混乱 物业经理态度恶劣 物业踢皮球 保安态度差 保安推搡人 保安和业主冲突 保安不作为 保安打人 停车场混乱 地下车库积水 地下室漏水 公共区域积水 监控坏了 监控不清晰 小区安全问题严重 曝光 实名曝光 实名举报 全过程录音 监控曝光 证据曝光 求扩散 全网声援 维权失败 维权无门 踢皮球 不处理 拒绝处理 一直拖着 拖延解决 投诉无果 二次伤害 举报后报复 内容反转 占道经营 街道脏乱 垃圾堆放 路面破损 井盖松动 道路塌陷 交通信号灯坏 城市内涝 下水道堵塞 臭水沟 乱搭乱建 违建 噪音扰民 深夜施工 工地扰民 工地扬尘 污染严重 黑烟排放 违规排污 河水发臭 动物扰民 野猪 蛇出现 害虫泛滥 环境脏乱差 市政不作为 政务服务差 推诿 拒绝办理 窗口态度差 偷排污水 偷排废气 黑烟 刺鼻气味 河道污染 饮水污染 工厂排污 化工泄漏 化学品气味 垃圾焚烧臭味 浓烟滚滚 树木倒塌 虫害 野生动物出没 农药污染 噪音超标 光污染 油烟扰民 地震 震感强烈 房屋摇晃 洪水 暴雨 积水 塌方 滑坡 泥石流 雷击事故 大风倒树 冰雹砸车 暴雪瘫痪 桥塌了 坠落事故 机械故障 爆裂 爆炸声 疑似爆炸 漏气味 设备故障 工程事故</div>
                            <div class="word-count hot">29 条</div>
                        </div>
                        <div class="word-index">1/1</div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num high">4-5</span><span class="time-info">00时58分~06时35分</span><span class="count-info">7次</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7578879331192078377/" target="_blank" class="news-link">日本军事准备细节曝光</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">抖音</span><span class="rank-num ">8-15</span><span class="time-info">00时58分~15时43分</span><span class="count-info">12次</span>
                            </div>
                            <div class="news-title"><a href="https://www.douyin.com/hot/2324262" target="_blank" class="news-link">香港火灾已致156人遇难</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">3</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">微博</span><span class="rank-num ">11-29</span><span class="time-info">00时58分~13时41分</span><span class="count-info">11次</span>
                            </div>
                            <div class="news-title"><a href="https://s.weibo.com/weibo?q=%23%E6%97%A5%E6%9C%AC%E6%88%98%E4%BA%89%E5%87%86%E5%A4%87%E6%9B%9D%E5%85%89%23&amp;t=31&amp;band_rank=11&amp;Refer=top" target="_blank" class="news-link">日本战争准备曝光</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">4</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">贴吧</span><span class="rank-num ">12-21</span><span class="time-info">00时58分~15时43分</span><span class="count-info">12次</span>
                            </div>
                            <div class="news-title"><a href="https://tieba.baidu.com/hottopic/browse/hottopic?topic_id=28347649&amp;amp;topic_name=%E5%A4%AE%E8%A7%86%E5%A4%96%E5%8D%96%E7%9F%AD%E7%89%87%E7%BF%BB%E8%BD%A6%2C%E5%81%87%E9%AA%91%E6%89%8B%E6%88%90%E6%9B%BF%E7%BD%AA%E7%BE%8A" target="_blank" class="news-link">央视外卖短片翻车,假骑手成替罪羊</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">5</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">贴吧</span><span class="rank-num top">2-16</span><span class="time-info">11时44分~23时51分</span><span class="count-info">7次</span>
                            </div>
                            <div class="news-title"><a href="https://tieba.baidu.com/hottopic/browse/hottopic?topic_id=28347680&amp;amp;topic_name=%E7%88%B1%E9%A9%AC%E4%BB%95%E5%B0%91%E7%88%B7%E9%81%87%E6%9D%80%E7%8C%AA%E7%9B%98%2C%E5%BA%95%E8%A3%A4%E5%85%A8%E6%97%A0" target="_blank" class="news-link">爱马仕少爷遇杀猪盘,底裤全无</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">6</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num top">1-14</span><span class="time-info">01时47分~07时33分</span><span class="count-info">7次</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7578112690292326436/" target="_blank" class="news-link">汶川地震被救女孩与施救军人结婚</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">7</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">百度热搜</span><span class="rank-num ">6-13</span><span class="time-info">00时58分~07时33分</span><span class="count-info">8次</span>
                            </div>
                            <div class="news-title"><a href="https://www.baidu.com/s?wd=%E6%97%A5%E6%9C%AC%E5%86%9B%E4%BA%8B%E5%87%86%E5%A4%87%E6%9B%9D%E5%85%89%EF%BC%9A%E7%A0%94%E5%8F%91%E2%80%9C%E4%B8%87%E8%83%BD%E8%A1%80%E6%B5%86%E2%80%9D" target="_blank" class="news-link">日本军事准备曝光：研发“万能血浆”</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">8</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">微博</span><span class="rank-num ">13-15</span><span class="time-info">00时58分~07时33分</span><span class="count-info">8次</span>
                            </div>
                            <div class="news-title"><a href="https://s.weibo.com/weibo?q=%23%E5%A6%BB%E5%AD%90%E6%9B%9D%E5%85%89%E4%B8%88%E5%A4%AB%E7%94%9F%E5%89%8D%E5%87%BA%E8%BD%A8%E6%8D%89%E5%A5%B8%E8%A7%86%E9%A2%91%23&amp;t=31&amp;band_rank=14&amp;Refer=top" target="_blank" class="news-link">妻子曝光丈夫生前出轨捉奸视频</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">9</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">百度热搜</span><span class="rank-num ">8-29</span><span class="time-info">01时47分~07时33分</span><span class="count-info">7次</span>
                            </div>
                            <div class="news-title"><a href="https://www.baidu.com/s?wd=%E9%A6%99%E6%B8%AF%E8%AD%A6%E6%96%B9%E5%B0%B1%E5%A4%A7%E5%9F%94%E7%81%AB%E7%81%BE%E6%8B%98%E6%8D%9515%E4%BA%BA" target="_blank" class="news-link">香港警方就大埔火灾拘捕15人</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">10</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">微博</span><span class="rank-num ">16-29</span><span class="time-info">01时47分~07时33分</span><span class="count-info">7次</span>
                            </div>
                            <div class="news-title"><a href="https://s.weibo.com/weibo?q=%23%E6%B1%B6%E5%B7%9D%E5%9C%B0%E9%9C%87%E5%A5%B3%E5%AD%A917%E5%B9%B4%E5%90%8E%E5%92%8C%E6%96%BD%E6%95%91%E5%86%9B%E4%BA%BA%E7%BB%93%E5%A9%9A%23&amp;t=31&amp;band_rank=29&amp;Refer=top" target="_blank" class="news-link">汶川地震女孩17年后和施救军人结婚</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">11</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">17-28</span><span class="time-info">00时58分~07时33分</span><span class="count-info">7次</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7579083342446149674/" target="_blank" class="news-link">官方曝光医生收回扣：支架每条5千</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">12</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">微博</span><span class="rank-num ">9-26</span><span class="time-info">02时59分~06时35分</span><span class="count-info">5次</span>
                            </div>
                            <div class="news-title"><a href="https://s.weibo.com/weibo?q=%23%E9%A6%99%E6%B8%AF%E7%81%AB%E7%81%BE%E5%B7%B2%E9%80%A0%E6%88%90156%E4%BA%BA%E9%81%87%E9%9A%BE%23&amp;t=31&amp;band_rank=25&amp;Refer=top" target="_blank" class="news-link">香港火灾已造成156人遇难</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">13</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">百度热搜</span><span class="rank-num ">12-19</span><span class="time-info">11时44分~18时55分</span><span class="count-info">5次</span>
                            </div>
                            <div class="news-title"><a href="https://www.baidu.com/s?wd=%E5%A6%BB%E5%AD%90%E6%9B%9D%E5%85%89%E4%B8%88%E5%A4%AB%E7%94%9F%E5%89%8D%E5%87%BA%E8%BD%A8%E8%A2%AB%E6%8D%89%E5%A5%B8%E8%A7%86%E9%A2%91" target="_blank" class="news-link">妻子曝光丈夫生前出轨被捉奸视频</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">14</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num high">4-28</span><span class="time-info">07时33分~13时41分</span><span class="count-info">3次</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7578879331192078377/" target="_blank" class="news-link">日本战争准备曝光</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">15</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num high">5-19</span><span class="time-info">18时55分~23时51分</span><span class="count-info">3次</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7579510939779927561/" target="_blank" class="news-link">金龙鱼为何要为十年骗局买单</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">16</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">百度热搜</span><span class="rank-num high">5-17</span><span class="time-info">18时55分~19时48分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://www.baidu.com/s?wd=%E5%A4%AB%E5%A6%BB%E8%8A%B1500%E5%A4%9A%E4%B8%87%E4%B9%B0%E5%88%AB%E5%A2%85+%E8%BF%9D%E5%BB%BA%E9%9D%A2%E7%A7%AF200%E5%B9%B3" target="_blank" class="news-link">夫妻花500多万买别墅 违建面积200平</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">17</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">11</span><span class="time-info">18时55分~23时51分</span><span class="count-info">3次</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7579545804986646574/" target="_blank" class="news-link">四川绵阳发生山体火灾？假的</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">18</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">百度热搜</span><span class="rank-num ">11</span><span class="time-info">18时55分~23时51分</span><span class="count-info">3次</span>
                            </div>
                            <div class="news-title"><a href="https://www.baidu.com/s?wd=%E5%9B%9B%E5%B7%9D%E7%BB%B5%E9%98%B3%E5%8F%91%E7%94%9F%E5%B1%B1%E4%BD%93%E7%81%AB%E7%81%BE%E7%B3%BB%E8%B0%A3%E8%A8%80" target="_blank" class="news-link">四川绵阳发生山体火灾系谣言</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">19</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">百度热搜</span><span class="rank-num ">15-28</span><span class="time-info">11时44分~12时51分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://www.baidu.com/s?wd=%E6%B1%B6%E5%B7%9D%E5%9C%B0%E9%9C%87%E8%A2%AB%E6%95%91%E5%A5%B3%E5%AD%A9%E4%B8%8E%E6%96%BD%E6%95%91%E5%86%9B%E4%BA%BA%E7%BB%93%E5%A9%9A" target="_blank" class="news-link">汶川地震被救女孩与施救军人结婚</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">20</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">百度热搜</span><span class="rank-num ">22-24</span><span class="time-info">18时55分~19时48分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://www.baidu.com/s?wd=%E9%A6%99%E6%B8%AF%E8%AD%A6%E6%96%B9%E5%B0%B1%E5%A4%A7%E5%9F%94%E7%81%AB%E7%81%BE%E5%86%8D%E6%8B%98%E6%8D%956%E4%BA%BA" target="_blank" class="news-link">香港警方就大埔火灾再拘捕6人</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">21</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">百度热搜</span><span class="rank-num ">23-26</span><span class="time-info">18时55分~19时48分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://www.baidu.com/s?wd=%E9%A6%99%E6%B8%AF%E5%A4%A7%E5%9F%94%E7%81%AB%E7%81%BE%E5%B7%B2%E9%80%A0%E6%88%90159%E4%BA%BA%E9%81%87%E9%9A%BE" target="_blank" class="news-link">香港大埔火灾已造成159人遇难</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">22</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">抖音</span><span class="rank-num ">11</span><span class="time-info">23时51分</span>
                            </div>
                            <div class="news-title"><a href="https://www.douyin.com/hot/2325250" target="_blank" class="news-link">香港火灾已致159人遇难</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">23</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">微博</span><span class="rank-num ">20</span><span class="time-info">23时51分</span>
                            </div>
                            <div class="news-title"><a href="https://s.weibo.com/weibo?q=%23%E6%AD%A6%E6%B1%89%E8%AD%A6%E6%96%B9%E9%80%9A%E6%8A%A5%E7%94%B7%E5%AD%90%E6%8C%81%E5%88%80%E4%BC%A4%E4%BA%BA%E8%87%B4%E6%AD%BB%23&amp;t=31&amp;band_rank=20&amp;Refer=top" target="_blank" class="news-link">武汉警方通报男子持刀伤人致死</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">24</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">百度热搜</span><span class="rank-num ">23</span><span class="time-info">18时55分</span>
                            </div>
                            <div class="news-title"><a href="https://www.baidu.com/s?wd=%E9%A6%99%E6%B8%AF%E7%81%AB%E7%81%BE%E6%A5%BC%E5%AE%87%E5%86%85%E9%83%A8%E6%90%9C%E7%B4%A2%E5%B7%B2%E5%85%A8%E9%83%A8%E5%AE%8C%E6%88%90" target="_blank" class="news-link">香港火灾楼宇内部搜索已全部完成</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">25</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">百度热搜</span><span class="rank-num ">23</span><span class="time-info">23时51分</span>
                            </div>
                            <div class="news-title"><a href="https://www.baidu.com/s?wd=%E7%94%B7%E5%AD%90%E6%8C%81%E5%88%80%E4%BC%A4%E4%BA%BA%E8%87%B41%E6%AD%BB+%E6%AD%A6%E6%B1%89%E8%AD%A6%E6%96%B9%E9%80%9A%E6%8A%A5" target="_blank" class="news-link">男子持刀伤人致1死 武汉警方通报</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">26</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">24</span><span class="time-info">12时51分</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7578490809067618350/" target="_blank" class="news-link">美学者：中国是最不具威胁性的国家</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">27</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">24</span><span class="time-info">18时55分</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7579542336116362788/" target="_blank" class="news-link">香港火灾已致159人遇难</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item new">
                        <div class="news-number">28</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">百度热搜</span><span class="rank-num ">25</span><span class="time-info">23时51分</span>
                            </div>
                            <div class="news-title"><a href="https://www.baidu.com/s?wd=%E6%B2%A1%E4%B9%B0%E4%B8%9C%E8%A5%BF%E5%8D%B4%E6%94%B6%E5%88%B0%E5%BF%AB%E9%80%92%EF%BC%9F%E5%B0%8F%E5%BF%83%E6%96%B0%E8%AF%88%E9%AA%97%E5%A5%97%E8%B7%AF" target="_blank" class="news-link">没买东西却收到快递？小心新诈骗套路</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">29</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">微博</span><span class="rank-num ">30</span><span class="time-info">12时51分</span>
                            </div>
                            <div class="news-title"><a href="https://s.weibo.com/weibo?q=%E8%99%9A%E5%81%87%E7%9A%84%E8%B7%AF%E6%80%92%E7%97%87vs%E7%9C%9F%E6%AD%A3%E7%9A%84%E8%B7%AF%E6%80%92%E7%97%87&amp;t=31&amp;band_rank=30&amp;Refer=top" target="_blank" class="news-link">虚假的路怒症vs真正的路怒症</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="new-section">
                    <div class="new-section-title">本次新增热点 (共 4 条)</div>
                    <div class="new-source-group">
                        <div class="new-source-title">百度热搜 · 2条</div>
                        <div class="new-item">
                            <div class="new-item-number">1</div>
                            <div class="new-item-rank ">23</div>
                            <div class="new-item-content">
                                <div class="new-item-title"><a href="https://www.baidu.com/s?wd=%E7%94%B7%E5%AD%90%E6%8C%81%E5%88%80%E4%BC%A4%E4%BA%BA%E8%87%B41%E6%AD%BB+%E6%AD%A6%E6%B1%89%E8%AD%A6%E6%96%B9%E9%80%9A%E6%8A%A5" target="_blank" class="news-link">男子持刀伤人致1死 武汉警方通报</a>
                                </div>
                            </div>
                        </div>
                        <div class="new-item">
                            <div class="new-item-number">2</div>
                            <div class="new-item-rank ">25</div>
                            <div class="new-item-content">
                                <div class="new-item-title"><a href="https://www.baidu.com/s?wd=%E6%B2%A1%E4%B9%B0%E4%B8%9C%E8%A5%BF%E5%8D%B4%E6%94%B6%E5%88%B0%E5%BF%AB%E9%80%92%EF%BC%9F%E5%B0%8F%E5%BF%83%E6%96%B0%E8%AF%88%E9%AA%97%E5%A5%97%E8%B7%AF" target="_blank" class="news-link">没买东西却收到快递？小心新诈骗套路</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="new-source-group">
                        <div class="new-source-title">微博 · 1条</div>
                        <div class="new-item">
                            <div class="new-item-number">1</div>
                            <div class="new-item-rank ">20</div>
                            <div class="new-item-content">
                                <div class="new-item-title"><a href="https://s.weibo.com/weibo?q=%23%E6%AD%A6%E6%B1%89%E8%AD%A6%E6%96%B9%E9%80%9A%E6%8A%A5%E7%94%B7%E5%AD%90%E6%8C%81%E5%88%80%E4%BC%A4%E4%BA%BA%E8%87%B4%E6%AD%BB%23&amp;t=31&amp;band_rank=20&amp;Refer=top" target="_blank" class="news-link">武汉警方通报男子持刀伤人致死</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="new-source-group">
                        <div class="new-source-title">抖音 · 1条</div>
                        <div class="new-item">
                            <div class="new-item-number">1</div>
                            <div class="new-item-rank ">11</div>
                            <div class="new-item-content">
                                <div class="new-item-title"><a href="https://www.douyin.com/hot/2325250" target="_blank" class="news-link">香港火灾已致159人遇难</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="footer">
                <div class="footer-content">
                    由 <span class="project-name">TrendRadar</span> 生成 · 
                    <a href="https://github.com/sansan0/TrendRadar" target="_blank" class="footer-link">
                        GitHub 开源项目
                    </a>
                    <br>
                    <span style="color: #ea580c; font-weight: 500;">
                        发现新版本 3.5.0，当前版本 3.4.1
                    </span>
                </div>
            </div>
        </div>
        
        <script>
            async function saveAsImage() {
                const button = event.target;
                const originalText = button.textContent;
                
                try {
                    button.textContent = '生成中...';
                    button.disabled = true;
                    window.scrollTo(0, 0);
                    
                    // 等待页面稳定
                    await new Promise(resolve => setTimeout(resolve, 200));
                    
                    // 截图前隐藏按钮
                    const buttons = document.querySelector('.save-buttons');
                    buttons.style.visibility = 'hidden';
                    
                    // 再次等待确保按钮完全隐藏
                    await new Promise(resolve => setTimeout(resolve, 100));
                    
                    const container = document.querySelector('.container');
                    
                    const canvas = await html2canvas(container, {
                        backgroundColor: '#ffffff',
                        scale: 1.5,
                        useCORS: true,
                        allowTaint: false,
                        imageTimeout: 10000,
                        removeContainer: false,
                        foreignObjectRendering: false,
                        logging: false,
                        width: container.offsetWidth,
                        height: container.offsetHeight,
                        x: 0,
                        y: 0,
                        scrollX: 0,
                        scrollY: 0,
                        windowWidth: window.innerWidth,
                        windowHeight: window.innerHeight
                    });
                    
                    buttons.style.visibility = 'visible';
                    
                    const link = document.createElement('a');
                    const now = new Date();
                    const filename = `TrendRadar_热点新闻分析_${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}${String(now.getDate()).padStart(2, '0')}_${String(now.getHours()).padStart(2, '0')}${String(now.getMinutes()).padStart(2, '0')}.png`;
                    
                    link.download = filename;
                    link.href = canvas.toDataURL('image/png', 1.0);
                    
                    // 触发下载
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    button.textContent = '保存成功!';
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.disabled = false;
                    }, 2000);
                    
                } catch (error) {
                    const buttons = document.querySelector('.save-buttons');
                    buttons.style.visibility = 'visible';
                    button.textContent = '保存失败';
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.disabled = false;
                    }, 2000);
                }
            }
            
            async function saveAsMultipleImages() {
                const button = event.target;
                const originalText = button.textContent;
                const container = document.querySelector('.container');
                const scale = 1.5; 
                const maxHeight = 5000 / scale;
                
                try {
                    button.textContent = '分析中...';
                    button.disabled = true;
                    
                    // 获取所有可能的分割元素
                    const newsItems = Array.from(container.querySelectorAll('.news-item'));
                    const wordGroups = Array.from(container.querySelectorAll('.word-group'));
                    const newSection = container.querySelector('.new-section');
                    const errorSection = container.querySelector('.error-section');
                    const header = container.querySelector('.header');
                    const footer = container.querySelector('.footer');
                    
                    // 计算元素位置和高度
                    const containerRect = container.getBoundingClientRect();
                    const elements = [];
                    
                    // 添加header作为必须包含的元素
                    elements.push({
                        type: 'header',
                        element: header,
                        top: 0,
                        bottom: header.offsetHeight,
                        height: header.offsetHeight
                    });
                    
                    // 添加错误信息（如果存在）
                    if (errorSection) {
                        const rect = errorSection.getBoundingClientRect();
                        elements.push({
                            type: 'error',
                            element: errorSection,
                            top: rect.top - containerRect.top,
                            bottom: rect.bottom - containerRect.top,
                            height: rect.height
                        });
                    }
                    
                    // 按word-group分组处理news-item
                    wordGroups.forEach(group => {
                        const groupRect = group.getBoundingClientRect();
                        const groupNewsItems = group.querySelectorAll('.news-item');
                        
                        // 添加word-group的header部分
                        const wordHeader = group.querySelector('.word-header');
                        if (wordHeader) {
                            const headerRect = wordHeader.getBoundingClientRect();
                            elements.push({
                                type: 'word-header',
                                element: wordHeader,
                                parent: group,
                                top: groupRect.top - containerRect.top,
                                bottom: headerRect.bottom - containerRect.top,
                                height: headerRect.height
                            });
                        }
                        
                        // 添加每个news-item
                        groupNewsItems.forEach(item => {
                            const rect = item.getBoundingClientRect();
                            elements.push({
                                type: 'news-item',
                                element: item,
                                parent: group,
                                top: rect.top - containerRect.top,
                                bottom: rect.bottom - containerRect.top,
                                height: rect.height
                            });
                        });
                    });
                    
                    // 添加新增新闻部分
                    if (newSection) {
                        const rect = newSection.getBoundingClientRect();
                        elements.push({
                            type: 'new-section',
                            element: newSection,
                            top: rect.top - containerRect.top,
                            bottom: rect.bottom - containerRect.top,
                            height: rect.height
                        });
                    }
                    
                    // 添加footer
                    const footerRect = footer.getBoundingClientRect();
                    elements.push({
                        type: 'footer',
                        element: footer,
                        top: footerRect.top - containerRect.top,
                        bottom: footerRect.bottom - containerRect.top,
                        height: footer.offsetHeight
                    });
                    
                    // 计算分割点
                    const segments = [];
                    let currentSegment = { start: 0, end: 0, height: 0, includeHeader: true };
                    let headerHeight = header.offsetHeight;
                    currentSegment.height = headerHeight;
                    
                    for (let i = 1; i < elements.length; i++) {
                        const element = elements[i];
                        const potentialHeight = element.bottom - currentSegment.start;
                        
                        // 检查是否需要创建新分段
                        if (potentialHeight > maxHeight && currentSegment.height > headerHeight) {
                            // 在前一个元素结束处分割
                            currentSegment.end = elements[i - 1].bottom;
                            segments.push(currentSegment);
                            
                            // 开始新分段
                            currentSegment = {
                                start: currentSegment.end,
                                end: 0,
                                height: element.bottom - currentSegment.end,
                                includeHeader: false
                            };
                        } else {
                            currentSegment.height = potentialHeight;
                            currentSegment.end = element.bottom;
                        }
                    }
                    
                    // 添加最后一个分段
                    if (currentSegment.height > 0) {
                        currentSegment.end = container.offsetHeight;
                        segments.push(currentSegment);
                    }
                    
                    button.textContent = `生成中 (0/${segments.length})...`;
                    
                    // 隐藏保存按钮
                    const buttons = document.querySelector('.save-buttons');
                    buttons.style.visibility = 'hidden';
                    
                    // 为每个分段生成图片
                    const images = [];
                    for (let i = 0; i < segments.length; i++) {
                        const segment = segments[i];
                        button.textContent = `生成中 (${i + 1}/${segments.length})...`;
                        
                        // 创建临时容器用于截图
                        const tempContainer = document.createElement('div');
                        tempContainer.style.cssText = `
                            position: absolute;
                            left: -9999px;
                            top: 0;
                            width: ${container.offsetWidth}px;
                            background: white;
                        `;
                        tempContainer.className = 'container';
                        
                        // 克隆容器内容
                        const clonedContainer = container.cloneNode(true);
                        
                        // 移除克隆内容中的保存按钮
                        const clonedButtons = clonedContainer.querySelector('.save-buttons');
                        if (clonedButtons) {
                            clonedButtons.style.display = 'none';
                        }
                        
                        tempContainer.appendChild(clonedContainer);
                        document.body.appendChild(tempContainer);
                        
                        // 等待DOM更新
                        await new Promise(resolve => setTimeout(resolve, 100));
                        
                        // 使用html2canvas截取特定区域
                        const canvas = await html2canvas(clonedContainer, {
                            backgroundColor: '#ffffff',
                            scale: scale,
                            useCORS: true,
                            allowTaint: false,
                            imageTimeout: 10000,
                            logging: false,
                            width: container.offsetWidth,
                            height: segment.end - segment.start,
                            x: 0,
                            y: segment.start,
                            windowWidth: window.innerWidth,
                            windowHeight: window.innerHeight
                        });
                        
                        images.push(canvas.toDataURL('image/png', 1.0));
                        
                        // 清理临时容器
                        document.body.removeChild(tempContainer);
                    }
                    
                    // 恢复按钮显示
                    buttons.style.visibility = 'visible';
                    
                    // 下载所有图片
                    const now = new Date();
                    const baseFilename = `TrendRadar_热点新闻分析_${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}${String(now.getDate()).padStart(2, '0')}_${String(now.getHours()).padStart(2, '0')}${String(now.getMinutes()).padStart(2, '0')}`;
                    
                    for (let i = 0; i < images.length; i++) {
                        const link = document.createElement('a');
                        link.download = `${baseFilename}_part${i + 1}.png`;
                        link.href = images[i];
                        document.body.appendChild(link);
                        link.click();
                        document.body.removeChild(link);
                        
                        // 延迟一下避免浏览器阻止多个下载
                        await new Promise(resolve => setTimeout(resolve, 100));
                    }
                    
                    button.textContent = `已保存 ${segments.length} 张图片!`;
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.disabled = false;
                    }, 2000);
                    
                } catch (error) {
                    console.error('分段保存失败:', error);
                    const buttons = document.querySelector('.save-buttons');
                    buttons.style.visibility = 'visible';
                    button.textContent = '保存失败';
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.disabled = false;
                    }, 2000);
                }
            }
            
            document.addEventListener('DOMContentLoaded', function() {
                window.scrollTo(0, 0);
            });
        </script>
    </body>
    </html>
    